<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="/assets/style.css" />

  <title>Document</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
</head>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".ButtonMinus").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        const input = btn
          .closest(".Recamaras")
          .querySelector("input.InputNumberC");
        let v = parseInt(input.value, 10);
        input.value = isNaN(v) ? 0 : Math.max(0, v - 1);
      });
    });
    document.querySelectorAll(".ButtonPlus").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        const input = btn
          .closest(".Recamaras")
          .querySelector("input.InputNumberC");
        let v = parseInt(input.value, 10);
        input.value = isNaN(v) ? 1 : v + 1;
      });
    });
  });
</script>

<body>
  <div data-layer="step 3 - casa" class="Step11">
    <div data-layer="wrapper" class="Wrapper">
      <div data-layer="header" class="Header">
        <div data-layer="logo" class="Logo">
          <div data-layer="datalpine" class="Datalpine">
            <img data-layer="logo_image" class="LogoImage" src="..\tools\logo.png" />
            <img data-layer="DatLogo" class="Datlogo" src="..\tools\DatLogo.png" />
          </div>
        </div>
        <a href="https://datalpine.mx/exploradores/" data-layer="Primary BTN" class="PrimaryBtn">
          <div data-layer="Button Text" class="ButtonText">Exploradores</div>
        </a>
      </div>
    </div>
    <div data-layer="form_step" class="FormStep3">
      <div data-layer="titulo" class="Titulo">Registro de la propiedad</div>
      <div data-layer="desc" class="DescText">
        Asegúrese de ingresar todos los detalles, especialmente los
        obligatorios.
      </div>
      <div data-layer="step_form" class="StepForm StepForm33">
        <div data-layer="progreso" class="Progreso2 Progreso33">
          <div data-layer="steps" class="Steps">
            <div data-layer="step1_bar" class="Step1Bar">
              <div data-layer="Rectangle 4357" class="Rectangle4357 Rectangle4357Complete"></div>
            </div>

            <div data-layer="step2_bar" class="Step2BarComplete Step2BarComplete2"></div>

            <div data-layer="step3_bar" class="Step3Bar Step3BarComplete">
              <div data-layer="Rectangle 4357" class="Rectangle4358"></div>
            </div>

            <div data-layer="step1_progreso" class="Step1Progreso Step1ProgresoComplete">
              <div data-layer="Ellipse 435" class="Ellipse435 Ellipse435Complete"></div>
              <div data-layer="1" class="numberOne numberOneComplete">
                <p>1</p>
              </div>
            </div>
            <div data-layer="step2_progreso" class="Step2Progreso">
              <div data-layer="Ellipse 436" class="Ellipse438 Ellipse438Complete"></div>
              <div data-layer="2" class="TwoC">
                <p>2</p>
              </div>
            </div>
            <div data-layer="step3_progreso" class="Step3Progreso">
              <div data-layer="Ellipse 437" class="Ellipse439 Ellipse439Complete"></div>
              <div data-layer="3" class="TreeC">
                <p>3</p>
              </div>
            </div>
            <div data-layer="step4_progreso" class="Step4Progreso">
              <div data-layer="Ellipse 437" class="Ellipse437 Ellipse437Complete"></div>
              <div data-layer="4" class="NumberFourNot NumberFourNotComplete">
                <p>4</p>
              </div>
            </div>
          </div>
        </div>
        <div data-layer="line" class="Line"></div>
        <div data-layer="step3" class="Step3">
          <div data-layer="titulo_step" class="TituloStep">
            <div data-layer="titulo" class="TituloStep1">
              Características de la Propiedad
            </div>
            <div data-layer="desc" class="DescStep">
              Proporcionar las características de su propiedad
            </div>
          </div>
          <div data-layer="step" class="Step33">
            <div data-layer="condition" class="Condition">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="Nombre ConditioName">
                  Condición<samp>*</samp>
                </div>
              </div>
              <select data-layer="condicion" class="InputCondi">
                <option value="">Seleccione</option>
                <option value="Buena">Buena</option>
                <option value="Excelente">Excelente</option>
                <option value="Construcción">En construcción</option>
                <option value="">Seleccione</option>
              </select>
            </div>

            <div data-layer="ano" class="Ano">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="Nombre AnoCons">
                  Año de construcción<samp>*</samp>
                </div>
              </div>
              <input type="text" data-layer="input-año" class="InputLada1Ano" placeholder="0000" required />
              <small id="anoErrorMsg" style="color: red; display: none;">El año debe estar entre 1600 y 2025</small>

            </div>
          </div>

          <br>
          <div data-layer="step" class="StepTerreno">
            <div data-layer="m_terreno" class="MTerreno">
              <div data-layer="titulo" class="MTerrenoText">
                <div data-layer="titulo_text" class="Nombre">
                  m² Terreno<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputMT">
                <input type="number" data-layer="input-terreno" class="InputLada2" placeholder="0" required />
              </div>
            </div>
            <div data-layer="m_construc" class="MConstruc">
              <div data-layer="titulo" class="Nombre">
                <div data-layer="titulo_text" class="Nombre">
                  m² Construcción<samp>*</samp>
                </div>
              </div>

              <div data-layer="input">
                <input type="number" data-layer="input-construccion" class="InputLada2" placeholder="0" required />
              </div>
            </div>
          </div>
          <div data-layer="step" class="Step4">
            <div data-layerk="recamaras" class="Recamaras">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="TituloR">
                  Recámaras<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputRecamaras">
                <button data-layer="button-minus" class="ButtonMinus">
                  <div data-layer="minus" class="Minus">
                    <div data-layer="Vector" class="VectorButton"></div>
                  </div>
                </button>
                <input type="text" data-layer="input-recamara" class="InputNumberC" placeholder="0" required />
                <button data-layer="button-plus" class="ButtonPlus">
                  <span data-layer="plus" class="Plus">
                    <span data-layer="Vector" class="VectorButtonPlus"></span>
                    <span data-layer="VectorButtonPlus2" class="VectorButtonPlus2"></span>
                  </span>
                </button>
              </div>
            </div>
            <div data-layer="estacion" class="Recamaras">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="TituloR">
                  Estacionamientos<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputRecamaras">
                <button data-layer="button-minus" class="ButtonMinus">
                  <div data-layer="minus" class="Minus">
                    <div data-layer="Vector" class="VectorButton"></div>
                  </div>
                </button>
                <input type="text" data-layer="input-estacion" class="InputNumberC" placeholder="0" required />
                <button data-layer="button-plus" class="ButtonPlus">
                  <span data-layer="plus" class="Plus">
                    <span data-layer="Vector" class="VectorButtonPlus"></span>
                    <span data-layer="Vector" class="VectorButtonPlus2"></span>
                  </span>
                </button>
              </div>
            </div>
            <div data-layer="banos_compl" class="Recamaras">
              <div data-layer="titulo" class="Titulo BanosCompl">
                <div data-layer="titulo_text" class="TituloR">
                  Baños<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputRecamaras">
                <button data-layer="button-minus" class="ButtonMinus">
                  <div data-layer="minus" class="Minus">
                    <div data-layer="Vector" class="VectorButton"></div>
                  </div>
                </button>
                <input type="text" data-layer="input-estacion" class="InputNumberC" placeholder="0" required />
                <button data-layer="button-plus" class="ButtonPlus">
                  <span data-layer="plus" class="Plus">
                    <span data-layer="Vector" class="VectorButtonPlus"></span>
                    <span data-layer="Vector" class="VectorButtonPlus2"></span>
                  </span>
                </button>
              </div>
            </div>
            <div data-layer="banos_med" class="Recamaras">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="TituloR">
                  1/2 Baños<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputRecamaras">
                <button data-layer="button-minus" class="ButtonMinus">
                  <div data-layer="minus" class="Minus">
                    <div data-layer="Vector" class="VectorButton"></div>
                  </div>
                </button>
                <input type="text" data-layer="input-estacion" class="InputNumberC" placeholder="0" required />
                <button data-layer="button-plus" class="ButtonPlus">
                  <span data-layer="plus" class="Plus">
                    <span data-layer="Vector" class="VectorButtonPlus"></span>
                    <span data-layer="Vector" class="VectorButtonPlus2"></span>
                  </span>
                </button>
              </div>
            </div>
          </div>

          <div data-layer="step" class="StepTerreno2">
            <div data-layer="amenidades" class="Amenidades">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="Nombre">
                  Amenidades extra:<samp>*</samp>
                </div>
              </div>
              <div data-layer="input_amenities" class="InputAmenidades">
                <div data-layer="input_content" class="InputContentAme">
                  <div data-layer="input" class="InputAm">
                    <div data-layer="content" class="Content">
                      <div data-layer="tags" class="Tags">
                        <div data-layer="badge" class="Badge">
                          <div data-layer="tag" class="Tag">
                            <div data-layer="placeholder" class="PlaceholderT">
                              <input type="checkbox" id="amenidad_piscina" name="amenidad_piscina" />
                              <label for="amenidad_piscina">Piscina</label>
                            </div>
                          </div>
                        </div>
                        <div data-layer="badge" class="Badge">
                          <div data-layer="tag" class="Tag">
                            <div data-layer="placeholder" class="Placeholder">
                              <input type="checkbox" id="amenidad_jardin" name="amenidad_jardin" />
                              <label for="amenidad_jardin">Jardín</label>
                            </div>
                          </div>
                        </div>

                        <div data-layer="badge" class="Badge">
                          <div data-layer="tag" class="Tag">
                            <div data-layer="placeholder" class="Placeholder">
                              <input type="checkbox" id="amenidad_balcon1" name="amenidad_balcon1" />
                              <label for="amenidad_balcon1">Balcón</label>
                            </div>
                          </div>

                        </div>
                        <div data-layer="badge" class="Badge">
                          <div data-layer="tag" class="Tag">
                            <div data-layer="placeholder" class="Placeholder">
                              <input type="checkbox" id="amenidad_balcon2" name="amenidad_balcon2" />
                              <label for="amenidad_balcon2">Balcón</label>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div data-layer="step" class="StepTerreno PrecioStep">
            <div data-layer="precio" class="Precio">
              <div data-layer="titulo" class="Titulo">
                <div data-layer="titulo_text" class="Nombre">
                  Define un precio para la propiedad<samp>*</samp>
                </div>
              </div>
              <div data-layer="input" class="InputPrecio">
                <input type="text" data-layer="input-precio" class="InputLada1" placeholder="0" required />
                <select data-layer="input" class="InputLada1" required>
                  <option value="MXN">MXN</option>
                  <option value="USD">USD</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-layer="navigation" class="Navigation">
        <a href="/form/step2.html" data-layer="Secondary BTN" class="SecondaryBtn">
          <div data-layer="Button Text" class="ButtonTextWhite">Anterior</div>
        </a>
        <a href="/form/step4.html" data-layer="Primary BTN" id="btnSiguiente" class="PrimaryBtn">
          <div data-layer="Button Text" class="ButtonText">Siguiente</div>
        </a>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {

      const amenCheckboxes = document.querySelectorAll("input[type='checkbox'][name^='amenidad_']");

      function saveAmenidades() {
        const seleccionadas = Array.from(amenCheckboxes)
          .filter(cb => cb.checked)
          .map(cb => {
            const label = document.querySelector(`label[for='${cb.id}']`);
            return label ? label.textContent.trim() : cb.value || cb.name;
          });
        sessionStorage.setItem("amenidades", JSON.stringify(seleccionadas));
      }

      amenCheckboxes.forEach(cb => cb.addEventListener("change", saveAmenidades));

      const savedAmen = sessionStorage.getItem("amenidades");
      if (savedAmen) {
        try {
          const arr = JSON.parse(savedAmen);
          amenCheckboxes.forEach(cb => {
            const label = document.querySelector(`label[for='${cb.id}']`);
            const text = label ? label.textContent.trim() : cb.value || cb.name;
            cb.checked = arr.includes(text);
          });
        } catch (e) {
          console.warn("Error parseando amenidades:", e);
        }
      }

      const formFields = {
        Condicion: document.querySelector(".InputCondi"),
        AnoConstruccion: document.querySelector(".InputLada1[placeholder='0000']"),
        mTerreno: document.querySelector("input[data-layer='input-terreno']"),
        mConstruccion: document.querySelector("input[data-layer='input-construccion']"),
        Recamaras: document.querySelectorAll("input.InputNumberC")[0],
        Estacionamiento: document.querySelectorAll("input.InputNumberC")[1],
        Banos: document.querySelectorAll("input.InputNumberC")[2],
        mediobano: document.querySelectorAll("input.InputNumberC")[3],
        Precio: document.querySelector("input[data-layer='input-precio']"),
        Moneda: document.querySelector("select[data-layer='input']")
      };

      const anoErrorMsg = document.getElementById("anoErrorMsg");

      for (const key in formFields) {
        const input = formFields[key];
        if (!input) continue;

        const storedValue = sessionStorage.getItem(key);
        if (storedValue) {
          input.value = storedValue;
        }

        input.addEventListener("input", () => {
          let value = input.value.trim();

          if (key === "AnoConstruccion") {
            value = value.replace(/\D/g, "").slice(0, 4);
            input.value = value;
            const year = parseInt(value, 10);
            if (value.length === 4 && (year < 1600 || year > 2025)) {
              input.setCustomValidity("El año debe estar entre 1600 y 2025");
              anoErrorMsg && (anoErrorMsg.style.display = "block");
            } else {
              input.setCustomValidity("");
              anoErrorMsg && (anoErrorMsg.style.display = "none");
            }
          } else if (key === "Precio") {
            value = value.replace(/\D/g, "").slice(0, 12);
            input.value = value;
            input.setCustomValidity("");
          } else if (["mTerreno", "mConstruccion", "Recamaras", "Estacionamiento", "Banos", "mediobano"].includes(key)) {
            value = value.replace(/\D/g, "");
            input.value = value;
          }

          sessionStorage.setItem(key, input.value.trim());
        });
      }

      const nextBtn = document.getElementById("btnSiguiente");
      if (nextBtn) {
        nextBtn.addEventListener("click", function (e) {
          let allValid = true;

          for (const key in formFields) {
            const input = formFields[key];
            if (!input.value.trim() || !input.checkValidity()) {
              input.classList.add("input-error");
              allValid = false;
            } else {
              input.classList.remove("input-error");
            }
          }

          if (!allValid) {
            e.preventDefault();
            alert("Por favor, completa todos los campos correctamente.");
            return;
          }

          saveAmenidades();

          for (const key in formFields) {
            sessionStorage.setItem(key, formFields[key].value.trim());
          }
        });
      }
    });
  </script>










</body>

</html>